<div *ngIf="control.autenticato && control.newthread"
     class="newTD">
  <div class="form-group part1">
    <input type="text" class="form-control" id="titolo" placeholder="Inserisci titolo..." [(ngModel)]="titolo">
  </div>
  <div class="form-group part3">
    <textarea type="text" class="form-control" id="testo" placeholder="Inserisci testo..."
              [(ngModel)]="testo"></textarea>
  </div>
  <div class="form-group part2">
    <button (click)=addThread() class="btnSubmit">Pubblica</button>
  </div>
</div>

<div class="author-popup" *ngIf="popbox">
  <div>
    <img src="{{popuser.image}}" width="38" height="38">
  </div>
  <div class="author-info">
    <p>{{popuser.nome}} {{popuser.cognome}}</p>
    <p>Et√† {{popuser.eta}} anni</p>
  </div>
</div>

<div *ngFor="let thread of threads; let i = index" [attr.data-index]="i">
  <div class="thread-box" *ngIf="thread.view">

    <button class="btn-close"
            *ngIf="control.autenticato && thread.autore === user.username"
            (click)=delete(i,true);
    ></button>

    <div class="thread-sub2">

      <p class="author"><i>Author <b (mouseover)="setPopupUser(thread.autore)" (mouseleave)="setPopupUser(thread.autore)" [ngStyle]="{'cursor': 'pointer'}">{{thread.autore}} </b></i></p>
      <p class="creato" >{{thread.creato}}</p>
      <h1 (click)=expand_thread(i)
      >{{thread.titolo}}</h1>
      <p class="thread-text"
         *ngIf="thread.expand"
      >{{thread.testo}}</p>

      <div class="thread-bar">
        <img src="./assets/images/arrow-up.png"
             class="icon"
             (click)=reactionControl(i,true,true)>
        <p class="reaction-p">{{thread.like.length - thread.dislike.length}}</p>
        <img src="./assets/images/arrow-down.png"
             class="icon"
             (click)=reactionControl(i,true,false)>

        <div class="comment"
             (click)=expand_comments(i,true)
             *ngIf="thread.expand"
        ><img src="./assets/images/chat.png"
              class="icon"
        >
          <p>{{thread.commcounter}}</p>
        </div>

        <div class="answer"
             *ngIf="thread.expand && control.autenticato"
             (click)="answer_form(i, true)"
        ><img src="./assets/images/answer.png"
              class="icon">
        </div>

        <img src="./assets/images/send.png"
             class="icon"
             *ngIf="thread.answer"
             (click)="addComment(i, true)">
      </div>

      <textarea type="text"
                class="form-control"
                id="testo_"
                placeholder="Inserisci testo..."
                *ngIf="thread.answer"
                [(ngModel)]="testo_"
      ></textarea>

    </div>
  </div>
</div>

<div *ngFor="let comment of comments; let i = index" [attr.data-index]="i">
  <div class="comment-box"
       [ngStyle]="{'margin-left': (comment.level+1)*10+'px'}"
       *ngIf="comment.view">

    <button class="btn-close"
            *ngIf="control.autenticato && comment.autore === user.username"
            (click)=delete(i,false);
    ></button>

    <div class="thread-sub2">
      <p class="author"><i>Author <b (mouseover)="setPopupUser(comment.autore)" (mouseleave)="setPopupUser(comment.autore)" [ngStyle]="{'cursor': 'pointer'}">{{comment.autore}}</b> level <b>{{comment.level}}</b></i></p>
      <p class="thread-text"
      >{{comment.testo}}</p>
    </div>

    <div class="thread-bar">
      <img src="./assets/images/arrow-up.png"
           class="icon"
           (click)=reactionControl(i,false,true)>
      <p class="reaction-p">{{comment.like.length - comment.dislike.length}}</p>
      <img src="./assets/images/arrow-down.png"
           class="icon"
           (click)=reactionControl(i,false,false)>
      <img class="down-arrow">

      <div class="comment"
           (click)=expand_comments(i,false)
      ><img src="./assets/images/chat.png"
            class="icon"
      >
        <p>{{comment.commcounter}}</p>
      </div>

      <div class="answer"
      ><img src="./assets/images/answer.png"
            class="icon"
            *ngIf="control.autenticato"
            (click)="answer_form(i, false)"
      ></div>

      <img src="./assets/images/send.png"
           class="icon"
           *ngIf="comment.answer"
           (click)="addComment(i, false)">

    </div>

    <textarea type="text"
              class="form-control"
              id="testo__"
              placeholder="Inserisci testo..."
              *ngIf="comment.answer"
              [(ngModel)]="testo__"
    ></textarea>

  </div>
</div>



